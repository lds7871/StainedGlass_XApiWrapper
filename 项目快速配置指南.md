# ğŸš€ StainedGlass_XApiWrapper é¡¹ç›®å¿«é€Ÿé…ç½®æŒ‡å—

## ç¯å¢ƒé…ç½®

### éœ€è¦å‡†å¤‡
- **æ“ä½œç³»ç»Ÿ**: Windows / Linux / macOSï¼ˆæˆ‘ä¸ç¡®å®šï¼‰
- **Java**: JDK 17+
- **Maven**: 3.8.x / 3.9.x
- **MySQL**: 8.0+
- **Nginx**: 1.20+ (ç”¨äºåå‘ä»£ç†)(è¿˜éœ€è¦è‡ªå»ºæˆ–å¯¼å…¥SSLè¯ä¹¦)
- **å…¬ç½‘åœ°å€**ï¼šéœ€è¦æœ¬åœ°ç½‘ç»œç©¿é€æˆ–äº‘æœåŠ¡å™¨(OAuth2.0è®¤è¯å¿…é¡»)

###  å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
- cp src/main/resources/application.yml.example src/main/resources/application.yml
- cp src/main/resources/config.properties.example src/main/resources/config.properties

###  OAuth2.0
Xå¼€å‘å¹³å°éœ€è¦OAuth2.0è®¤è¯ï¼Œæ‰€ä»¥å¿…é¡»è¦é…ç½®å…¬ç½‘å›è°ƒåœ°å€ï¼ˆymlä¸­callback-urlï¼‰ï¼Œæ­¤å¤–S256å’ŒPECKä¸ç”¨æ‰‹åŠ¨é…ç½®

---
## é…ç½®æµç¨‹(è‡³å°‘éœ€è¦çš„å¿…è¦æµç¨‹)

- **å¯è®¿é—®åœ°å€**ï¼šéœ€è¦å†…ç½‘ç©¿é€æˆ–äº‘æœåŠ¡å™¨ï¼ˆå³å¯è¢«å…¬ç½‘è®¿é—®çš„ç½‘å€ï¼‰
- **Nginx**: æŒ‰ç…§./Nginxé…ç½®é‡Œçš„æ–‡ä»¶è¦†ç›–æˆ–åˆå¹¶Nginxï¼Œæ³¨æ„è¿˜éœ€è¦SSLè¯ä¹¦
- **ç½‘ç»œä»£ç†**ï¼šå».src/main/resourcesçš„config.propertiesé…ç½®
- **Xå¼€å‘å¹³å°APPåˆ›å»º**ï¼šè®¿é—® [Twitter Developer Portal](https://developer.twitter.com/en/portal/dashboard)åˆ›å»º Appã€‚è·å– Client ID å’Œ Client Secretã€‚é…ç½®å›è°ƒåœ°å€ï¼ˆhttp://xxx.xxx.xxx.xx/callback/twitter/oauthï¼‰ã€‚
- **åˆ›å»ºæ•°æ®è¡¨**ï¼š.src/main/resourcesä¸‹æœ‰å»ºè¡¨æ–‡ä»¶ï¼ŒMySQL8
- **é…ç½®resources**ï¼šå¤åˆ¶.yml.propertiesçš„exampleã€‚å¹¶å¯åŠ¨â€œBå¿«é€Ÿé…ç½®.cmdâ€è¿›è¡Œé…ç½®
- **Maven**ï¼šä¸‹è½½Mvnå¹¶ç‚¹å‡»ç¼–è¯‘å’Œå¯åŠ¨ä¸¤ä¸ªcmd
- **è®¤è¯**ï¼šè°ƒç”¨/callback/twitter/authorize->æ‰“å¼€å“åº”ç½‘é¡µ->ç‚¹å‡»æˆæƒ->è‡ªåŠ¨æ‰§è¡Œ/callback/twitter/oauth->æˆæƒæˆåŠŸé¡µé¢è¿”å›Json


## æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| Spring Boot | 3.1.4 | æ ¸å¿ƒæ¡†æ¶ |
| MyBatis-Plus | 3.5.3 | æ•°æ®åº“ ORM æ¡†æ¶ |

### æ•°æ®åº“
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| MySQL | 8.0+ | ä¸»æ•°æ®åº“ |
| MySQL Connector | 8.0.33 | JDBC é©±åŠ¨ |

### API æ–‡æ¡£
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| Springfox Swagger | 3.0.0 | API è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ |
| Swagger UI | 3.0.0 | API ç•Œé¢è®¿é—® |

### å·¥å…·åº“
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| Lombok | 1.18.30 | ä»£ç ç”Ÿæˆï¼ˆgetter/setterï¼‰ |
| FastJSON 2 | 2.0.40 | JSON è§£æ |
| Twitter4j | 4.0.7 | Twitter API å®¢æˆ·ç«¯ |
| OSHI | 6.4.3 | ç¡¬ä»¶ä¿¡æ¯è·å– |
| Brotli | 0.1.2 | æ•°æ®è§£ç  |
| Commons Codec | 1.15 | ç¼–ç è§£ç å·¥å…· |

### Java ç‰ˆæœ¬
```
Java 17 (LTS)
Maven Compiler Source: 17
Maven Compiler Target: 17
```

---

## ç³»ç»Ÿæ¶æ„

### é¡¹ç›®ç»“æ„
```
src/main/java/LDS/Person/
â”œâ”€â”€ config/                    # é…ç½®ç±»
â”‚   â”œâ”€â”€ CorsConfig.java       # CORS è·¨åŸŸé…ç½®
â”‚   â”œâ”€â”€ MybatisPlusConfig.java# MyBatis-Plus é…ç½®
â”‚   â”œâ”€â”€ SecurityFilter.java   # å®‰å…¨è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ SwaggerConfig.java    # Swagger é…ç½®
â”‚   â”œâ”€â”€ TwitterAccessTokenFilter.java  # Token è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ TwitterApiClient.java # Twitter API å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ TwitterProperties.java# Twitter é…ç½®å±æ€§
â”‚   â””â”€â”€ MemoryOAuthStateStore.java    # OAuth çŠ¶æ€å­˜å‚¨
â”‚
â”œâ”€â”€ controller/                # æ§åˆ¶å™¨ï¼ˆAPI ç«¯ç‚¹ï¼‰
â”‚
â”‚
â”œâ”€â”€ dto/                       # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ request/              # è¯·æ±‚æ¨¡å‹
â”‚   â”‚
â”‚   â””â”€â”€ response/             # å“åº”æ¨¡å‹
â”‚
â”œâ”€â”€ entity/                    # æ•°æ®åº“å®ä½“
â”‚
â”‚
â”œâ”€â”€ repository/                # æ•°æ®åº“è®¿é—®å±‚
â”‚
â”‚
â”œâ”€â”€ service/                   # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚
â”‚   â””â”€â”€ impl/                 # æœåŠ¡å®ç°
â”‚
â”œâ”€â”€ tasks/                     # å®šæ—¶ä»»åŠ¡
â”‚   â”œâ”€â”€ TwitterTokenRefresher.java    # Token åˆ·æ–°ä»»åŠ¡
â”‚   â””â”€â”€ logic/                        # ä»»åŠ¡é€»è¾‘
â”‚
â””â”€â”€ util/                      # å·¥å…·ç±»
    â”œâ”€â”€ TwitterRateLimitHandler.java
    â””â”€â”€ TwitterOAuthTestUtil.java
```

---


## æ•°æ®åº“/Twitter OAuth/Session/MyBatis-Plus/ç«¯å£/æ—¥å¿—é…ç½®

### æ–‡ä»¶ä½ç½®
éƒ¨åˆ†è¯´æ˜è¯·è¯¦è§
`src/main/resources/application.yml.example`

### OAuth 2.0 é…ç½®æƒé™èŒƒå›´è¯´æ˜
| æƒé™ | è¯´æ˜ |
|-----|------|
| `tweet.read` | è¯»å–æ¨æ–‡ |
| `tweet.write` | å†™å…¥ï¼ˆå‘å¸ƒï¼‰æ¨æ–‡ |
| `users.read` | è¯»å–ç”¨æˆ·ä¿¡æ¯ |
| `offline.access` | ç¦»çº¿è®¿é—®ï¼ˆåˆ·æ–°ä»¤ç‰Œï¼‰ |
| `media.write` | ä¸Šä¼ åª’ä½“ |
| `like.write` | ç‚¹èµæ“ä½œ |
### é…ç½®æ­¥éª¤
1. è®¿é—® [Twitter Developer Portal](https://developer.twitter.com/en/portal/dashboard)
2. åˆ›å»ºæˆ–é€‰æ‹©ç°æœ‰ App
3. è·å– Client ID å’Œ Client Secret
4. è®¾ç½®å›è°ƒ URL: 
5. æ›´æ–° `application.yml` ä¸­çš„å‡­è¯

---

## Nginx é…ç½®

### æ–‡ä»¶ä½ç½®
`Nginxé…ç½®/nginx.conf`
æ ¹æ®ä½ çš„å®é™…æƒ…å†µä¸æ–‡ä»¶åˆå¹¶


---

## config.properties é…ç½®

### æ–‡ä»¶ä½ç½®
éƒ¨åˆ†è¯´æ˜è¯·è¯¦è§
`src/main/resources/config.properties.example`

---

## é¡¹ç›®å¯åŠ¨

### å¿«é€Ÿè¿è¡Œæ–¹å¼
**Windows æ‰¹å¤„ç†è„šæœ¬**ï¼š
- `Aç¼–è¯‘.cmd` - ç¼–è¯‘é¡¹ç›®
- `Aå¯åŠ¨.cmd` - å¯åŠ¨åº”ç”¨

### ç¼–è¯‘æ‰“åŒ…
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
mvn clean package

# è·³è¿‡æµ‹è¯•å¿«é€Ÿæ‰“åŒ…
mvn clean package -DskipTests
```

### è¿è¡Œæ–¹å¼

#### æ–¹å¼ 1: ç›´æ¥è¿è¡Œ Java JAR
```bash
java -jar target/Auto_Scheduled_Task-1.0-SNAPSHOT.jar
```

#### æ–¹å¼ 2: ä½¿ç”¨ Maven è¿è¡Œ
```bash
mvn spring-boot:run
```

#### æ–¹å¼ 3: IDE è¿è¡Œ
- åœ¨ IDE ä¸­æ‰“å¼€ `XAutoApplication.java`
- ç‚¹å‡»"Run"æˆ–æŒ‰ `Shift+F10`ï¼ˆIDEAï¼‰

---


## Token ç®¡ç†

### Token æœ‰æ•ˆæœŸ
- **è®¿é—® Token**: 2 å°æ—¶
- **åˆ·æ–°è§¦å‘**: å‰©ä½™æ—¶é—´ < 30 åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°
- **è‡ªåŠ¨ç»´æŠ¤**: âœ… ç³»ç»Ÿåå°è‡ªåŠ¨å¤„ç†

### Token å­˜å‚¨
- **æ•°æ®åº“è¡¨**: `twitter_token`
- **å­˜å‚¨å†…å®¹**: 
  - `user_id` - Twitter ç”¨æˆ· ID
  - `access_token` - è®¿é—®ä»¤ç‰Œ
  - `refresh_token` - åˆ·æ–°ä»¤ç‰Œ
  - `expires_at` - è¿‡æœŸæ—¶é—´
  - `created_at` - åˆ›å»ºæ—¶é—´
  - `updated_at` - æ›´æ–°æ—¶é—´

---


**æ–‡æ¡£æ›´æ–°æ—¶é—´**: 2025-11-14
